#########################
ファイルの操作
#########################

.. contents::


オブジェクトファイル
=============================

本アプリでポーズやモーションをさせるオブジェクトです。

次のとおりです。WebGL画面にドラッグアンドドロップにも対応しています。

* Vroid/VRM(.vrm)
* その他3Dオブジェクト(.obj, .fbx, .zip, .gltf ,.glb, .ply, .stl, .3mf)
* 画像(.png, .jpg, .gif)
* 音楽・音声ファイル(.mp3, .wav)

.. caution::
    音楽・音声ファイルはドラッグアンドドロップに対応していません。

オブジェクトファイルを再び開く
    本アプリはウェブアプリである関係上、PCやスマートフォンなどのデバイスのストレージを直接参照することができません。

    そのため、一度開いたオブジェクトファイルを履歴に保存する設定をしておく必要があります。（これがデフォルトです）

    履歴に保存しておくことにより、プロジェクトファイルと同時にオブジェクトファイルも開くことができます。

    履歴の保存容量は使用するブラウザのIndexedDBの制限に従います。

.. hint::
    各OS版はデバイスのストレージを直接参照可能です。この場合、履歴に保存されるのはファイルパスだけです。

本アプリで読み書きできるファイルの扱い
=========================================

　本アプリで作成され、また読み込むことができるファイルの注意点を説明します。

.. hint::
    これらのファイルは自由に配布可能です。

    WebGL画面にドラッグアンドドロップして読み込み可能です。

プロジェクトファイル
----------------------

    他の説明は :ref:`saveproject` や :ref:`openproject` をご覧ください。

    :拡張子: ``.vvmproj``

    使用可能なストレージとタイミング
        .. csv-table::
            :header-rows: 1

            アプリ環境, タイミング,  内部ストレージ, 端末のストレージ
            ウェブアプリ, 初回,  読み込み/書き込み, 読み込み
            ウェブアプリ, 2回目以降, 読み込み/書き込み, 書き込み（ダウンロードとしてのみ）
            各OS版, 初回, 読み込み/書き込み, 読み込み/書き込み
            各OS版, 2回目以降, 読み込み/書き込み, 読み込み/書き込み
        

    プロジェクトファイルに関連するデータ
        キャスト（VRMなどオブジェクト）
            タイムライン（ロール）に割り当てているオブジェクトの名称や形状・その他特別な情報があればそれらを保持します。

            プロジェクトファイルを開く際のオブジェクトの実際の情報は次の通りです。

            :ウェブアプリ版: ファイルオブジェクト自体アプリ内に保存
            :各OS版: ファイルパスやサイズ・種類のみアプリ内に保存
        
        モーションデータ
            | タイムライン（ロール）が対象です。キーフレームに登録した当時のオブジェクトの大きさ・形状を参考情報として保持します。
            | タイムライン（ロール）とキャストの割当方法は :ref:`settingcast2role` をご覧ください。
        
        プロジェクト自体の情報
            特に使いませんがプロジェクト名や説明文を保持可能です。

モーションファイル
-------------------

    詳しい説明は :ref:`savemotionfile` や :ref:`openmotionfile` をご覧ください。

    :拡張子: 
        ``.vvmmot``

        　単一のタイムライン（ロール）のモーションデータ。キーフレームに登録した当時のオブジェクトの大きさ・形状を参考情報として保持します。

        　オブジェクト種類が一致していれば実際のキャスト（オブジェクト）には依存しません。VRMの場合、身長差は自動的に計算して再現されます。

        本アプリ独自のモーションフォーマットで、すべての情報が保持されます。

    :拡張子:
        ``.fbx``

        3Dモデルですが内部にアニメーションを保持することができるフォーマットです。本アプリでは ``OtherObject`` という分類で読み込まれます。対象のアニメーションを再生するには、OtherObjectのプロパティ内で選択してください。

        再生やシーク・スピード変更もそのUIの中で行います。

    :拡張子: 
        ``.anim``

        UnityのAnimationClipです。モーションに含まれるボーンの構造の関係上、後述のVRMAnimationなどと同じ動きにはならない可能性があります。

        出力のみ対応しています。

    :拡張子: 
        ``.vrma``

        VRMAnimationです。 .vrmaファイルはUniVRMで新しく定義されたVRM専用のモーションフォーマットです。詳しくは下記をご覧ください。

        `VRMC_vrm_animation - GitHub <https://github.com/vrm-c/vrm-specification/blob/master/specification/VRMC_vrm_animation-1.0/README.ja.md>`_

        VRMAnimationは読み込み・出力両方とも対応しています。

        読み込み
            VRMのアニメーションプロパティで指定してください。
        
            再生やシーク・スピード変更もそのUIの中で行います。

        出力
            リボンバーのモデルタブにて操作します。

            .. image:: ../man3/posing_2.png
                :align: center


ポーズファイル
----------------

    詳しい説明は :doc:`../man3/posing_save` や :doc:`../man3/posing_open` をご覧ください。

    :拡張子: ``.vvmpose``

    　VRMのみ使用可能。単位のタイムライン（ロール）の取得時のポーズデータ。キーフレームに登録している必要なく取得し保存可能です。取得当時のオブジェクトの大きさ・形状を参考情報として保持します。

    　実際のキャスト（オブジェクト）には依存しません。身長差は自動的に計算して再現されます。

    本アプリ独自のモーションフォーマットで、すべての情報が保持されます。実際は1フレームだけのモーションデータです。


